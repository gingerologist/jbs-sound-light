# Overview

本目录下文档视为剧本杀声光电系统中与设备有关部分的**软件详细设计**文档；原腾讯企业云盘内的文档视为需求，需求分析，系统分析和通讯协议参考设计文档。



## 1. 量产交付

### 1.1 硬件

| No   | 名称     | 说明                                                         |
| ---- | -------- | ------------------------------------------------------------ |
| H1   | 智能灯泡 | 使用`esp32-c3-mini-1`模块作为主控，5路pwm调光，rgb和冷白（c）暖白（w），A60 |
| H2   | 音箱网关 | 包含`esp32-wrover-ie`和`esp32-c3-mini-1u`模块，dsp音效处理，功放，喇叭，按键，line-in；<br />wrover模块负责与云通讯下载脚本，依据脚本下载和存储音频内容，播放音频，向c3模块发送灯效指令；<br />c3模块负责与环境内的灯泡组网，控制灯效。 |
| H3   | 完整包装 | 路由器 x1<br />音箱网关 x1，具有唯一的二维码标识（打印，mac地址）<br />灯 x10，有组内编号（印刷标贴），二维码标识（喷码，mac地址）<br />贴在剧本杀房间内桌面上的二维码标识（打印）<br />其它包装内印刷品，填充物等 |

说明：完整包装的操作流程很复杂，详见repack文档（尚无）；



### 1.2 软件

| No    | 名称                              | 功能说明                                                     |
| ----- | --------------------------------- | ------------------------------------------------------------ |
| C3-1  | 灯C3模块最小量产固件              | 包含boot ota<sup>1</sup>，ota，涂鸦产测                      |
| C3-2  | 灯C3模块的ota固件                 | 仅ota分区的用户功能应用                                      |
| C3H-1 | C3H<sup>2</sup>模块的最小量产固件 | 包含boot ota<sup>1</sup>，ota，产测要求（？）                |
| C3H-2 | C3H<sup>2</sup>模块的ota固件      | 仅ota分区的用户功能应用                                      |
| W1    | Wrover模块的最小量产固件          | 包含boot ota<sup>1</sup>，ota，产测要求（？），repack业务要求（！） |
| W2    | Wrover模块的ota固件               | 仅ota分区和用户功能应用                                      |

1. boot ota指bootloader阶段的ota，原则上可以强刷包括partition table在内的所有内容；
2. 用C3H指音箱网关内的C3模块；
3. c3, c3h, wrover均支持多种方式的ota升级，详见ota文档；其中c3h支持wrover从串口注入ota固件；



## 2. 工程交付

工程交付指在工程过程中需要的辅助开发工具，开发或业务人员内部使用的工具软件等；以下为不完全列表，其它工程交付需要从场景需求推导。

| Code Name | 说明     | 功能                                                         |
| --------- | -------- | ------------------------------------------------------------ |
| C3M       | C3开发板 | 相当于ESP32-C3-DevkitM-1开发板上的LED灯修改成和本产品一致的情况，方便开发 |
| Mozart    | PC软件   | 1. 可直连WiFi路由器实现超级路由器功能，完成boot ota功能和repack业务；<br />2. 可直连WiFi路由器模仿云，完成wrover模块的开发调试；<br />3. 可直连DevkitM-1开发板或者自制的C3开发板（H0），模仿音箱网关； |



## 3. 场景

### A 生产类

| 编号 |                |                                   |
| ---- | -------------- | --------------------------------- |
| A1   | 灯的量产测试   | 使用C3-1固件                      |
| A2   | 音箱的调试     | ？？？                            |
| A3   | 音箱的量产测试 | Wrover使用W1固件，C3使用C3H-1固件 |

### B 开发调试类

| 编号       | 说明                               | 需要的软硬件支持                                             | 交付产出                           |
| ---------- | ---------------------------------- | ------------------------------------------------------------ | ---------------------------------- |
| B1（大类） | 灯的固件开发                       | C3M开发板（部分功能可以用DevkitM-1开发板替代）               |                                    |
| B2         | 声光电编辑软件的开发（而不是使用） | 1. C3M开发板作为灯，使用C3-2的测试版固件；<br />2. C3M开发板或DevkitM-1开发板，使用C3H-2的测试版固件； | 声光电效果demo<br />可调试灯效定义 |



#### B1 灯的固件开发

需要C3开发板支持，包括







## 4. 其它重要事项

